##快速定位慢 SQL


在上一节介绍了怎样通过KeyVis来识别TiDB的业务的模式，本节主要带领读者体会写怎么样通过dashbaord信息来定位慢SQL，从而达到帮助运维人员快速定位SQL性能问题。

###SQL语句分析(Statements)
SQL 语句分析功能用来查看 SQL 语句在集群上执行的统计情况，可以用来分析哪些类别的SQL 语句耗时过长，消耗内存过多等情况，帮助用户定位性能问题。

注:下面所称的 SQL 语句实际指的是某一类 SQL 语句。语法一致的 SQL 语句会规一划为一 类相同的 SQL 语句。
比如 “SELECT * FROM employee WHERE id IN (1, 2, 3)” 和 “select * from EMPLOYEE where ID in (4, 5)” 最后都会被规一划为 “select * from employee where id in (...)”。

###查看 SQL 语句的整体情况
登录后，在左侧点击「SQL 语句分析」即可进入此功能页面。在时间区间选项框中选择要分 析的时间段即可得到该时段所有数据库的 SQL 语句执行统计情况，如果只关心某些数据库， 则可以在第二个选项框中选择相应的数据库对结果进行过滤，支持多选。

结果以表格的形式展示，并支持按不同的列对结果进行排序。
1. 选择一份分析的时间段
2. 支持按数据库过滤
3. 支持按不同的指标排序

![1.png](/res/session3/chapter3/slow-query-table/1.png)

目前的已知问题:
1. 对于内部 SQL 语句来说，数据库这一列内容为空
2. 选择时间段时，只能从下拉框中选择固定的时间段，暂不支持自定义的任意时间段


###查看单个 SQL 语句的详情
在 SQL 类别列点击某类 SQL 语句，可以进入该 SQL 语句的详情页查看更详细的信息，以及 该 SQL 语句在不同节点上执行的统计情况。
单个Statements详情页关键信息：

1. SQL执行总时长
2. 平均影响行数（一般是写入）
3. 平均扫描行数（一般是读）
4. 各个节点执行指标，分析出某个节点性能瓶颈
![2.png](/res/session3/chapter3/slow-query-table/2.png)

如果有耗时的SQL可以通过前面章节介绍的KeyVis来进行分析

